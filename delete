dos2unix bucket_list.txt



enable_bpa_from_file.sh



#!/bin/bash

BUCKET_FILE="bucket_list.txt"

if [ ! -f "$BUCKET_FILE" ]; then
  echo "‚ùå Bucket list file not found: $BUCKET_FILE"
  exit 1
fi

while read -r bucket; do
  # Skip empty lines
  [[ -z "$bucket" ]] && continue

  echo "üîí Enabling Block Public Access on bucket: $bucket"

  aws s3api put-public-access-block \
    --bucket "$bucket" \
    --public-access-block-configuration \
      BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true

  if [ $? -eq 0 ]; then
    echo "  ‚úÖ BPA enabled"
  else
    echo "  ‚ùå Failed (check permissions or bucket name)"
  fi

  echo "--------------------------------------"
done < "$BUCKET_FILE"

echo "üéâ BPA process completed"
